																链接

链接是将各种代码和数据片段手机并组合称为一个单一文件的过程，这个文件可被加载到内存并执行。

链接可以执行与编译时，也可以执行与加载时，甚至可以在运行时执行。早期链接是手动执行，现在通过链接器的程序进行自动执行。

静态链接器以一组可重定位目标文件和命令行参数作为输入，生成一个完全链接的、可以加载和运行的可执行目标文件作为输出。

链接器必须完成的任务：

1、符号解析，将目标文件定义和引用符号，每个符号对应于一个函数、一个全局变量或一个静态变量。

疑问 ：是否java中的变量是否与符号解析有关联呢，是否通过C语言惊醒关联的呢？

2、重定位编译器和汇编器生成从地址0开始的代码和数据

GNU READELE 程序是一个查看目标文件内容的很方便工具。

链接器解析符号引用的方法是将每个引用于他输入的可重定位目标文件的符号表中的一个确定的符号定义关联起来。

函数和已出初始化的全局变量是强符号，为初始化的全局变量是弱符号。

产生疑问：符号与java 中的引用有关系吗？

Linux 链接器使用下面古泽来处理多重定义的符号名：

1、不允许有多个同名的强符号；

2、如果有一个强符号和多个弱符号同名，则会选择强符号；

3、如果有多个弱符号同名，从中任意选择一个。

基本重定向类型：

R_X86_64_PC32：重定向一个使用32位PC相对地址的引用。

R_X86_64_32:重定位一个使用32位绝对地址的引用。

可执行目标文件的格式类似于可重定位目标文件的格式，ELF头描述文件的总体格式。

共享库是一个目标模块，在运行时或加载时，可以加载到任意的内存地址，并和一个内存中的程序连接起来，是有一个叫做动态链接器的程序执行的。

动态库执行过程：

![image-20200612184352650](/Users/liuchang/Library/Application Support/typora-user-images/image-20200612184352650.png)

Java中当一个增在运行的Java程序时图调用函数foo时，Java解释器利用dlopen借口动态链接和加载fo o.so，在调用foo。

想要生成对全局变量PIC引用的编译器利用了这个事实，他在数据段开始的地方创建一个表，叫做全局偏移量表。

描述笔记：

AR：创建静态库，插入、删除、列出和提取成员。

STRINGS：列出一个目标文件中所有可打印的字符串。

STRIP：从目标文件中删除符号表信息。

NM：列出一个目标文件的符号表中定义的符号。

SIZE：列出目标文件中节的名字和大小。

READELF：显示一个目标文件的完整结构，包括ELF头中编码的所有信息，包含SIZE 和NM的功能。

OBJDUMP：所有二进制工具之母。能够显示一个目标文件中所有的信息。他的最大的作用就是反汇编.text节中的二进制指令。

链接在 java 中体现在那个情境下呢，java 使用的动态链接是加载时还是运行时呢？