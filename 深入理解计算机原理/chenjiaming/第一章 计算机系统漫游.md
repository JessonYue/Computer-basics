# 第一章 计算机系统漫游

本章关键词：计算机概要



## 1.1 信息就是位+上下文 

系统中所有的信息，都由一串比特表示。区分不同数据对象的唯一方法是看这些数据对象的上下文。



## 1.2 程序被翻译成不同的格式

举例子：

hello.c      ---      (预处理器cpp)--->     hello.i --     (编译器ccl)      --> 

hello.s汇编程序     ---(编译器as) --->     hello.o 可重定位目标程序，二进制

----(链接器ld) --->      hello可执行目标程序，二进制



## 1.3 了解编译系统的好处

- 优化程序性能
- 理解链接时出现的错误
- 避免安全漏洞



## 1.4 处理器读并解释储存在内存中的指令

### 1.4.1 系统的硬件组成

- 总线 ： 贯穿整个系统的一组电子管道。
- I/O设备：每个IO设备都通过一个控制器或者适配器与IO总线相连。
- 主存：临时存储设备，处理器执行程序时，用来存放程序和程序处理的数据。DRAM芯片。 线性的字节数组，每个字节都有唯一的地址（数组索引）。
- 处理器：CPU，解释或执行 存储在主存中指令的引擎。cpu核心是一个大小为一个字的存储设备或者寄存器，就是程序计数器pc。在任何时刻，pc都可以指向主存中的某条指令的地址。cpu一直轮询pc指向的指令。
- 

## 1.5高速缓存

机械原理：较大的存储设备比较小的存储设备运行得慢。

高速缓存存储器，在cpu芯片内。比访问主存的速度要快！L1、L2、L3高速缓存，静态随机访问存储器SRAM



## 1.6存储设备的层次结构

- L0：寄存器：cpu寄存器保存来自高速缓存存储器的字

- L1/L2/L3  SRAM:   向下读取高速缓存
- 主存 DRAM : 保存本地磁盘的磁盘块
- 本地二级存储（本地磁盘）
- 远程二级存储（分布式文件系统、web服务器）
- 

## 1.7 操作系统管理硬件

操作系统的基本功能：

- 防止硬件被滥用
- 向APP提供简单的Api来控制低级硬件设备

抽象：

文件==IO设备

虚拟内存==主存和磁盘IO设备

进程==对 处理器、主存和IO设备

### 1.7.1 进程

进程： 是操作系统对一个正在运行的程序的一种抽象。

时间、执行、用户代码、内核代码、上下文切换 。  在P12

### 1.7.2 线程

一个进程拥有多个线程，每个线程运行在进程的上下文中，共享代码和全局数据。

### 1.7.3 虚拟内存 

虚拟内存，抽象概念。每个进程在独占使用主存（假象）。每个进程看到的内存都是一致的，称为虚拟地址空间。

这个空间的组成（由上到下）：

- 内核虚拟内存：给内核用的

- 用户栈：给编译器用的， 用它实现函数调用。调用函数，栈增长；函数return时，栈收缩。

- 共享库的内存映射区域：存放c标准库，数学库等共享库的代码和数据的区域。

- 运行时堆（运行时malloc创建）：动态扩展和收缩。调用malloc、free。

- 程序代码和数据：***代码是从同一固定地址开始，紧接着的是和 C全局变量和相对应的数据位置。代码和数据区是直接按照可执行目标文件的内容初始化的。？？？？***

### 1.7.4 文件

文件就是 字节序列。每个io设备，都可以看成文件。



## 1.8 系统间网络通信

网络---网络适配器----把数据复制到主存。



## 1.9 重要主题

### 1.9.1 Amdahl定律

核心思想：当我们对系统的某个部分加速时，对整个系统性能的影响取决于该部分的重要性和加速程度。

想要显著加速整个系统，必须提升全系统中相当大的部分的 的速度。

加速比：s= 1/((1-a)+a/k)  ，k是某部分提升性能，a是某部分 占 总的比例。

### 1.9.2 并发和并行

#### 1 线程级并发

多核处理器，每个cpu都有L1/L2，L1两部分，保存最近取到的指令和存放数据。

超线程（同时多线程）：允许一个cpu执行多个控制流。i7处理器可以让每个核执行两个线程。

#### 2 指令级并行

现代处理器可以同时执行多条指令的属性称为指令级并行。

#### 3 单指令、多数据并行

许多现代处理器拥有特殊的硬件，允许一条指令产生多个可以并行执行的操作。SIMD并行。

### 1.9.3 计算机系统中抽象的重要性

操作系统的四个抽象：

文件==IO设备

虚拟内存==程序存储器

进程==正在运行的程序

虚拟机==整个计算机的抽象



## 本章疑问

1.7.3 虚拟内存 ，程序代码和数据，同一个固定地址？



















