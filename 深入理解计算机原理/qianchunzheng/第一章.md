## 计算机系统漫游

### 信息就是位+上下文

操作系统中所有的信息，包括磁盘文件，内存中的程序，内存中存放的用户数据以及网络上传送的数据都是由值0和1组成的**位（又称比特）序列**，8个位被组成一组称作**字节**，区分不同数据对象的唯一方法是我们读到这些数据对象时的**上下文**

### 程序被其他程序翻译称不同的格式

我们所写的代码（以C语言为例）为方便被人读懂而设计的，但是如果想要在系统上运行，那么我们所写的每一行代码都必须通过其他程序转换称低级机器语言指令。然后这些指令按照一种称为**可执行目标程序**的格式打好包，并以二进制磁盘文件的形式存放起来。**目标程序也称为可执行目标文件**

在Unix系统上，从源文件到目标文件的转换是由**编译器驱动程序**完成的，下面是C语言编译的四个阶段：

1. ***预处理阶段*** ：预处理器（CPP）根据指令将我们在代码中导入的其他代码全部读取并且插入到当前程序文本中。然后得到了另外一个C程序，通常以`.i`作为扩展名
2. ***编译阶段*** ：编译器（ccl）将文本文件（以`.i`作为扩展名的文件）通过**汇编语言程序**翻译成以`.s`作为扩展名的文件。汇编语言就是将不同的高级语言的不同编译器翻译成相同的汇编语言，以供程序执行。
3. ***汇编阶段*** ：汇编器（as）将以`.s`作为扩展名的文件翻译成机器语言指令。将这些指令打包成一种叫做**可重定位目标程序**的格式，并将结果保存在以`.o`作为扩展名的文件中
4. ***链接阶段***：链接器（ld）将代码中调用的第三方的函数以某种方式合并到当前的文件中，然后将其加载到内存中，由系统执行

### 处理器读并解释储存在内存中的指令

以C语言为例，经过上述四个阶段，我们已经把`.C`文件转换成`.o`文件并存放在磁盘上。此时我们如果想在系统（以unix）上执行该文件，我们需要借助名为**shell**的程序。shell 是一个命令行解释器，通过它我们可以执行我们的代码

### 系统的硬件组成

1. ***总线***：贯穿系统的一组电子管，主要负责在各个部件之间传递信息
2. ***I/O设备***：即输入输出设备，就是系统获取外界输入和展示系统输出的设备，例如鼠标键盘就是输入设备，显示器就是输出设备
3. ***主存***：是一个临时储存设备，在处理程序时，用来存放程序和程序处理的数据的。
4. ***处理器***：中央处理单元，简称处理器，是解释或执行存储在主存中指令的引擎，

### 程序运行流程

以C语言，运行hello.c文件为例

1. 当我运行`./hello`命令后，shell程序将字符读到寄存器中，然后再把它放到内存中
2. 当我们在敲回车键时，shell程序就知道我们已经结束了命令输入，然后shell程序就回执行一系列指令来加载`hello.o`（即可执行文件），然后再将目标文件中的代码和数据复制到主存
3. 一旦目标文件中的代码和数据复制到主存，处理器就开始执行hello程序中的main程序中的机器语言指令，这些指令经过一系列处理将结果从主存复制到寄存器文件，再从寄存器文件复制到显示设备上

### 系统中的一些基本概念

#### 进程

进程是操作系统对一个正在运行的程序的一中抽象。

#### 并发

一个进程的指令和另一个进程的指令交错进行

#### 线程

系统的最小执行单元，一个进程中可以有多个线程。同一进程中的线程都运行在相同的上下文下。

#### 虚拟内存

每个进程在主存中使用的内存空间。每个进程看到的内存都是一致的，称为***虚拟地址空间*** ,以Linux为例，从下往上可分为：

	1. 程序代码和数据
 	2. 堆
 	3. 共享库
 	4. 栈
 	5. 内核虚拟内存

#### 文件

即字节序列

### Amdahl定律

主要思想：

当我们对系统某个部分加速时，其对系统整体性能的影响取决于该部分的重要性和加速程度。

公式：
$$
S=1/(1-a+a/n)
$$

## 本章问题

1. 不明白阿姆达尔定律在开发或编程中的作用