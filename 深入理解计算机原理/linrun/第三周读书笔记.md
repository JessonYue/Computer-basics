第五章：优化程序性能

 

第五章主要涉及到的知识点是在编程中提升程序的性能，编译器会做怎样的执行会有，着重举例了在一个循环中，怎样编程可以提高循环的效率。

优化循环体可以做以下的事情：

1.将一些计算结果不会变的代码移动到循环体外；

2.减少过程调用；

3.消除不必要的内存引用，可引入局部变量替代重复使用到的内存引用

4.可并发执行的循环的性能要优于难以并发执行的循环

另外，第五章还介绍了一些提高循环效率的技巧，比如：2x2循环展开以减少循环调用的次数，2x1a循环展开方式能更好的利用流水线的能，条件操作时，用条件数据传送会有更优的性能

 

第五章除了重点部分，其他内容没有细看

 

第六章：存储器层次结构

 

第六章让我认识到了SRAM，DRAM存储设备，但是它们是属于断电会丢失数据的存储设备。ROM和磁盘是非易失性的，重点介绍了磁盘的物理构造。固态硬盘是基于闪存（是非易失性的，基于ROM）的存储技术。

设备可以自己读写总线事务而不需要CPU干预的过程称为直接内存读取（DMA）

局部性：可分为时间局部性和空间局部性，就是说一个被引用内存可能在不就的将来被多次引用，一个被引用内存附近的空间在不就的将来很可能被使用。这样称为局部性良好。局部性良好的程序运行的更快。

这在循环调用时可以得到很明显的表现。

取指令的循环体越小，迭代次数越多，局部性越好。这条貌似和上一章的2x2循环展开相悖

 

缓存命中和缓存不命中：缓存命中率高的程序性能好，不命中的处罚在越低层次的存储设备中，代价越高昂。如何减少缓存不命中的数量，在提高循环运行速度上有很大的影响。在循环体中，碰到多维数组时，要注意提高空间局部性，减小步长。

 

第七章：链接

链接是将代码和数据片段合并成一个单一文件的过程。

目标文件：1.可重定位目标文件（在编译时，创建出一个可执行文件）；2.可执行目标文件（可以直接复制到内存并执行）；3.共享目标文件（也属于可重定位目标文件，在加载或运行时动态的加载进内存并链接）

编译器和汇编器生产可重定位目标文件。链接器生成可执行目标文件

符号有三种：一种是由本模块定义并被其他模块引用的全局符号；一种是其他模块定义，被本模块引用的全局符号；还有一种是只被本模块定义和本模块引用的局部符号

 

对全局符号的解析比较棘手，对此，Linux链接器使用一下规则：

\1.   不允许有多个同名的强符号

\2.   如果有一个强符号和多个弱符号，选择强符号

\3.   如果多个弱符号同名，任意从中选一个

 

将所有相关目标模块集成打包成一个单独文件称为静态库。静态库的优点是可以不断的被重复利用，使用程序只需要在静态库中复制程序引用的目标模块

 

第七章后面内容还没有看完。对我来讲，概念比较陌生。可重定位目标文件那部分的内容对每个字段没有什么认识，只是通过阅读，看到意思。这章对我来讲，有很多很容需要消化和理解。希望在接下来的学习中，慢慢消化。