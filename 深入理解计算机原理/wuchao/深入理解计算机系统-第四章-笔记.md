## 第四章

## 处理器体系结构

### 指令集体系结构

	#### 	程序员可见状态

		1. 寄存器的值（指令读取或写入的数据）
  		2. 条件码(存储最近的算数或逻辑操作指令执行后的一些状态)
  		3. PC（存储当前指令的地址）
  		4. 内存
  		5. stat（程序状态：正常或异常）

### 处理器执行指令流程

1. 取指

   根据PC的值从内存中取出指令字节。

2. 译码

   将取出的指令字节中寄存器指示符代表的寄存器中的操作数。

3. 执行

   算数或逻辑运算。

4. 访存

   从内存读取数据或写入数据到内存。

5. 写回

   将结果写回到寄存器。

6. 更新PC

   将PC设置为下一条指令的地址。

### 处理器流水线设计

	* 非流水线的处理流程是一条指令的所有阶段执行完，再进行下一条指令的操作。
	* 流水线的处理流程是细化指令的处理阶段，将多个指令的处理阶段重叠，引入流水线寄存器，阶段的执行结果在流水线寄存器保存，不同指令的不同阶段的操作可以在同一时间进行。这样就加大了单位时间内指令的处理量。
 * 局限性
   1. 运行时钟的速率是由最慢的阶段决定的。也就是说假如最慢的阶段是A，同一时间一个指令的A阶段还在执行，另一个指令的B阶段已经结束了，只能等待A阶段执行完，才能进入到下个时钟周期。比A耗时少的阶段将空闲直到A结束。造成性能浪费。
   2. 指令阶段划分的过多，流水线寄存器也就越多，流水线寄存器的读写也是要耗费相当的时间的。这些性能损耗可能占到整个时钟周期的很大一部分。



