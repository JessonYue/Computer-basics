#### 3、程序的机器级表示

- 机器级编程存在两种尤为重要的抽象：

  	1. 指令集体系结构或指令集架构来定义机器级程序的格式和行为，定义了处理器的状态、指令的格式，以及每条指令对状态的影响
   	2. 机器级程序使用的内存地址是虚拟地址，提供的内存模型看上去是一个非常大的字节数组

- 一条机器指令只执行一个非常基本的操作

- store.c（c文件） -> store.s（汇编文件）-> store.o（目标文件-二进制格式）

- 命令行

  	1. linux> gcc  -0g -S  store.c  ->C语言编译器产生汇编代码（.s）
   	2. linux> gcc  -0g   -c store.c  ->gcc编译并汇编代码产生目标代码文件（.o）

- 一个x86-64的中央处理单元包含一组16个存储64位值的通用目的寄存器。发展从8个16位 -> 8个32位->8个64位再新增8个。不同的寄存器扮演着不同的角色，其中最特别的是栈指针%rsp，用来指明运行时栈的结束位置

- 大多数指令有一个或者多个操作数，指示出执行一个操作中要使用的源数据值以及放置结果的目的位置。因此，各种不同的操作数的可能性被分为三种类型：

  	1. 立即数，用来表示常数
   	2. 寄存器，表示某个寄存器的内容
   	3. 内存引用，会根据计算出来的地址，访问某个内存位置

- 栈-后进先出，栈顶元素的地址是所有栈中元素地址中最低的

- 逻辑操作分为四组：

  	1. 加载有效地址
   	2. 一元操作   -- 一个操作数
   	3. 二元操作   -- 两个操作数
   	4. 移位

- 控制

  	1. 条件码（CF：进位标志，ZF：零标志，SF：符号标志，OF：溢出标志）
   	2. 访问条件码
   	3. 跳转指令（jump）会导致执行切换到程序的一个全新的位置
   	4. 条件传送实现条件分支
   	5. 循环：do-while、 while、for
   	6. switch语句 - 跳转表

- 过程：软件中一种重要的抽象。提供了一种封装代码的方式，用一组指定的参数和一个可选的返回值实现了某种功能。类似于函数、方法等

- X86-64中，可以通过寄存器最多传递6个整型参数，超出的部分就要通过栈来传递

- 寄存器分为被调用者寄存器，调用者寄存器，栈指针%rsp

- 栈的原则提供适当的策略，当过程被调用时分配局部存储，当返回时释放存储

- C语言数组的一个不同寻常的特点是可以产生指向数组中元素的指针，并对指针进行运算

- 数组：

  	1. 数组 = 指针  & 取地址符  * 取值
   	2. 嵌套数组 = 二维数组
   	3. 定长数组  #define N  16 申明常量
   	4. 变长数组

- 结构（struct）：将多个对象集合到一个单位中

- 联合（union）：允许用几种不同的类型来引用一个对象

- struct *rp ,     (\*rp).width 等价于 rp -> width

- union 联合的总的大小等于它最大字段的大小

- 数据对齐：要求某种类型对象的地址必须是某个值K(通常是2、4、8)的倍数

- 指针

   1. 每个指针都对应一个类型

   2. 每个指针都有一个值

   3. 指针用&运算符创建

   4. *操作符用于间接引用指针

   5. 数组与指针的紧密联系

   6. 将指针从一种类型强制转换为另一种类型，只改变它的类型，不改变它的值

   7. 指针也可以指向函数    函数指针写法：返回类型 （*指针名）（函数参数）

      例子：int (*f)(int *)   f是一个指向以int *为参数并返回int类型的函数指针

----- 到3.10.3--- 