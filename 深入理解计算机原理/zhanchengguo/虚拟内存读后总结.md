#### 虚拟内存

- 虚拟内存是一种对主存的抽象概念，为每个进程提供一个大的、一致的和私有的地址空间
- 虚拟内存三个重要的能力
  	1. 将主存看成存储在磁盘上的地址空间的高速缓存，在主存中只保留活动区域，并根据需要在磁盘和主存之间来回拆地数据
   	2. 为每个进程提供一致的地址空间，简化内存管理
   	3. 保护每个进程的地址空间不被其他进程破坏
- 需要理解虚拟内存的原因：
  	1. 虚拟内存是核心的，遍及计算机系统的所有层面
   	2. 虚拟内存是强大的，可以创建和销毁内存片，将内存片映射到磁盘文件的某个部分，以及与其他进程共享内存
   	3. 虚拟内存是危险的，动态分配程序是，会与虚拟内存发生交互
- 9.1、物理和虚拟寻址：将一个虚拟地址转换为物理地址的任务叫做地址翻译
- 9.2、地址空间：是一个非负整数地址的有序集合；如果地址空间的整数是连续的，则说明是一个线性地址空间
- 9.3、虚拟内存被组织为一个由存放在磁盘上的N个连续的字节大小的单元组成的数组，每个字节都有唯一的虚拟地址，作为到数组的索引；VM系统通过将虚拟内存分割为称为虚拟页的大小固定的块来处理磁盘和主存的数据传输
- 在任意时刻，虚拟页的集合分为三个不相交的子集：
  	1. 未分配的：VM系统还未分配的页，不占任何磁盘空间
   	2. 已缓存的：当前已缓存在屋里内存中的已分配页
   	3. 未缓存的：未缓存在物理内存中的已分配页
- 9.3.1、DRAM缓存的组织结构：完全由巨大的不命中开销驱动的
- 9.3.2、页表：存放在物理内存中的数据结构，可以将虚拟页映射到物理页
- 9.3.3、页命中
- 9.3.4、缺页：DRAM缓存不命中称为缺页
- 虚拟内存的习惯说法：块被称为页；在磁盘和内存之间传送页的活动叫交换或者页面调度；页从磁盘换入DRAM（页面调入）或者从DRAM换出磁盘（页面调出）；一直等待，直到最后时刻，也就是当有不命中发生时，才换入页面的这种策略称为按需页面调度
- 9.3.5、分配页面
- 9.3.6、局部性：保证在任意时刻，程序将趋向于在一个较小的活动页面集合上工作，着集合叫左工作集或者常驻集合
- 9.4、操作系统未每个进程提供了一个独立的页表，也就是一个独立的虚拟地址空间
- 按需页面调度和独立的虚拟地址空间的结合，对系统中内存的使用和管理造成了深远的影响。VM简化了链接和加载、代码和数据共享，以及应用程序的内存分配
- 将一组连续的虚拟页映射到任意一个文件中的任意位置的表示法称为内存映射
- 9.5、虚拟内存作为内存保护的工具：通过在页表条目中（PTE）额外添加许可位来控制对一个虚拟页面内容的访问
- -----9.6--------

