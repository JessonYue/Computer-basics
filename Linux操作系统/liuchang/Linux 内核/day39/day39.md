### 页表处理

pte_t、pmd_t、pud_t和pgd_t 粉表描述页表项、页中间目录项、页上级目录和页全局目录的格式。

五个类型转换宏（_ _pte、 _ _pmd 、_ _ _pud 、 _ _pgd和 _ _pgprot）把一个无符号整数转换成所需的类型。

另外的五个类型转换宏（pte_val、pmd_val、pud_val、pgd_val和pgprot_val）执行相反的转换，即把上面提到的四种特殊的类型转换成一个无符号整数。

内核还提供了许多红和函数用于读或修改页表表项：

1、如果相应的表项值为0，那么，宏pte_none、pmd_none、pud_none和pgd_none产生的值为1，否则产生的值为0

2、宏 pte_clear、pmd_clear、pud_clear和pgd_clear 清除相应页表的一个表项，由此禁止进程使用由该页表映射的线性地址。ptep_get_and_clear（）函数清除一个页表项并返回前一个值。

3、set_pte、set_pmd、set_pud 和 set_pgd 向一个页表项中写入指定的值。set_pte_atomic 与 set_pte 的作用相同，但是当 PAE 被激活时他同样能保证 64 位的值被原子地写入。

4、如果 a 和 b 两个页表项指向同一页并且制定相同的访问优先级，那么 pte_same(a,b) 返回1 ，否则返回0。

### 物理内存分布

内核将下列页框记为保留：

1、在不可用的物理地址范围内的页框

2、含有内核代码和已初始化的数据结构的页框

3、保留页框中的页绝不能被动态分配或教导磁盘上

### 处理硬件高速缓存和 TLB

硬件高速缓存是通过高速缓存行寻址的，L1_CACHE_BYTES宏产生以字节为单位高速缓存行的大小。



