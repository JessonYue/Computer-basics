## 								第六章 定时测量

### 时钟和定时器电路

时钟电路同时用于跟踪当前时间和产生精确的时间度量。

定时器电路由内核编程，所以它们以固定的、预先定义的频率发出中断。

### 可编程间隔定时器（PIT）

PIT不是通过振铃，而是通过发出一个特殊的中断，也叫做时钟中断来通知内核有一个时间间隔过去了。

PIT 永远一内核确定的固定频率不停的发出中断。

在 Linux 的代码中，有几个宏产生决定时钟中断频率的常量：

1、HZ 产生每秒时钟中断的近似个数，也就是时钟中断的频率。

2、CLOCK_TICK_PATE 产生的值为 1 193 182，这个值是 8254 芯片的内部震荡器频率。

3、LATCH 产生 CLOCK_TICK_PATE 和 HZ 的比值再四舍五入后的整数值。

### Linux 计时体系结构

Linux 必定执行与定时相关的操作：

1、更新自系统启动以来所经过的事件。

2、更新时间和日期。

3、确定当前进程在每个 CPU 上一运行了多长时间，如果已经超过了分配给它的时间，则抢占它。

4、更新资源使用统计数。

5、检查每个如定时器的时间间隔是否已到。

### 计时体系机构的数据结构

### 定时器对象

![image-20200726214405205](https://tva1.sinaimg.cn/large/007S8ZIlgy1gh4pjdkapuj30vw0cwdmi.jpg)

![image-20200726214624355](https://tva1.sinaimg.cn/large/007S8ZIlgy1gh4pls1e3fj30wi09qjwf.jpg)

### 软定时器和延迟函数

动态定时器被动态地创建和撤销，对当前活动动态定时器的个数没有限制。











